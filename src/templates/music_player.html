{% extends "base.html" %}

{% block content %}

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<div class="music-app-container">
    <!-- Browser Section -->
    <div id="browser">
        <div class="browser-toggle" id="browserToggle">
            <button class="toggle-btn active" data-target="albums">Albumi</button>
            <button class="toggle-btn" data-target="tracks">Pesmi</button>
        </div>
        <div id="albums" class="albums-section">
            <div class="section-header">
                <i class="bi bi-disc"></i>
                <h2>Albumi</h2>
            </div>
            <div id="albumList" class="album-list"></div>
        </div>
        
        <div id="tracks" class="tracks-section">
            <div class="section-header">
                <i class="bi bi-music-note-beamed"></i>
                <h2>Pesmi</h2>
            </div>
            <input type="search" id="searchInput" placeholder="ğŸ” Iskanje po naslovu, izvajalcu..." class="search-input">
            <div id="trackList" class="track-list"></div>
        </div>
    </div>

    <!-- Player Section -->
    <div id="player" class="player-section">
        <div class="now-playing-info">
            <div class="album-cover">
                <i class="bi bi-music-note"></i>
            </div>
            <div class="track-info">
                <div id="nowPlayingTitle" class="track-title">Ni izbrane pesmi</div>
                <div id="nowPlayingArtist" class="track-artist"></div>
                <div id="nowPlayingAlbum" class="track-album"></div>
            </div>
        </div>

        <audio id="audio" preload="auto" playsinline></audio>

        <!-- Progress Bar -->
        <div class="progress-section">
            <input type="range" id="seekBar" class="progress-bar">
            <div class="time-display">
                <span id="timeDisplay">0:00 / 0:00</span>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls-section">
            <button class="control-btn" onclick="prev()" title="PrejÅ¡nja pesem">
                <i class="bi bi-skip-backward-fill"></i>
            </button>

            <button id="playBtn" class="control-btn btn-play" onclick="togglePlay()" title="Predvajaj / Pauziraj">
                <i id="playIcon" class="bi bi-play-fill"></i>
            </button>

            <button class="control-btn" onclick="next()" title="Naslednja pesem">
                <i class="bi bi-skip-forward-fill"></i>
            </button>

            <button id="shuffleBtn" class="control-btn btn-shuffle" onclick="toggleRandom()" title="NakljuÄni vrstni red">
                <i id="shuffleIcon" class="bi bi-shuffle"></i>
            </button>

            {% if view_as != "anonymous" and view_as != "user" and current_user.is_authenticated and current_user.is_admin %}
            <button id="delete-btn" class="control-btn btn-delete" onclick="izbrisiPesem()" title="IzbriÅ¡i pesem">
                <i class="bi bi-trash"></i>
            </button>
            {% endif %}
        </div>
    </div>
</div>

<div id="albums-root" data-albums='{{ albums | tojson | safe }}'></div>
<div id="metadata-root" data-music='{{ music_metadata | tojson | safe }}'></div>

<link rel="stylesheet" href="/static/css/music.css">
<script defer src="/static/script/music_player.js"></script>

{% endblock %}
